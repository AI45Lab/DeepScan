model:
  generation: qwen3
  model_name: Qwen3-8B
  device: cuda
  # Prefer "auto" unless you need to force a dtype for memory; it matches the checkpoint's torch_dtype.
  dtype: auto
  load_in_8bit: false
  path: /mnt/shared-storage-user/guojiaxuan/data/models/models--Qwen--Qwen3-8B
  trust_remote_code: true
  load_tokenizer: true
  # Reference generation parameters (deterministic)
  generation_config:
    do_sample: false
    temperature: 0.0
    top_p: 1.0
    top_k: 0
    repetition_penalty: 1.0

dataset:
  name: xboundary/diagnostic
  # Point this at your X-Boundary `data/` folder
  data_dir: /mnt/shared-storage-user/guojiaxuan/data/datasets
  num_samples_per_class: 200

evaluator:
  type: xboundary
  batch_size: 16
  max_length: 1024
  # Either specify explicit layers...
  # target_layers: [9, 18]
  # ...or comma-separated:
  # target_layers_csv: "9,18"
  # If omitted, defaults to 1/3 and 2/3 depth.
  save_metrics_json: true
  save_tsne: true

summarizer:
  type: xboundary
  select_by: separation_score
  include_both_selections: true


